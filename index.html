<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Security & Compliance Headers -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data:">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta name="referrer" content="no-referrer">
  <link rel="privacy-policy" href="privacy.html">
  <meta charset="UTF-8">
  <title>Bio-Vault | BalanceChain | TVM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="The next generation digital money vault—pegged, stable, audit-proof. 1 TVM = 1 USD. Powered by BalanceChain technology.">
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" href="icon-192.png">

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.error('SW registration failed:', err));
      });
    }
  </script>

  <!-- Ethers.js for blockchain integration -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.umd/dist/ethers.min.js"></script>

  <!-- Inline Styles -->
  <style>
    /* Reset & Base */
    html, body {
      margin: 0; padding: 0; min-height: 100vh;
      background: linear-gradient(to left, #2f4979, #15264d);
      color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      scroll-behavior: smooth; text-align: center;
    }
    h1,h2,h3 { margin: 10px 0; }
    .hidden { display: none !important; }
    button {
      background: #2258c4; color: #fff;
      padding: 10px 20px; border: none; border-radius: 5px;
      font-size: 16px; margin: 6px; cursor: pointer;
      transition: background .3s, box-shadow .2s;
    }
    button:hover { background: #144180; }
    button:focus { box-shadow: 0 0 0 3px #ffe164cc; outline: none; }
    .section { margin: 20px auto; max-width: 860px; width: 95%; }
    .input-field {
      padding: 10px; margin: 6px 6px 6px 0;
      border-radius: 4px; border: none; font-size: 16px;
      width: 45%; max-width: 300px;
    }
    .pass-wrap { position: relative; display: inline-block; }
    .show-hide-btn {
      position: absolute; top: 50%; right: 8px; transform: translateY(-50%);
      background: none; border: none; color: #2258c4; cursor: pointer;
      font-size: 14px; padding: 4px; outline: none;
    }
    /* Table */
    #transactionTable {
      width: 100%; border-collapse: collapse; background: #fff; color: #000;
      margin-top: 20px; border-radius: 6px; overflow: hidden;
    }
    #transactionTable th, #transactionTable td {
      padding: 12px; border-bottom: 1px solid #ccc; word-wrap: break-word;
      font-size: 15px; text-align: left;
    }
    #transactionTable th { background: #eaf0fa; }
    /* Modals & Popups */
    .modal, .popup {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.84); z-index: 1000;
      align-items: center; justify-content: center; animation: fadeIn .22s;
    }
    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
    .modal-content, .popup-content {
      background: #fff; color: #0e2242; padding: 30px;
      border-radius: 12px; max-width: 440px; width: 90%;
      box-shadow: 0 8px 48px rgba(0,0,0,0.3); position: relative;
      animation: scaleIn .18s; text-align: left; font-size: 16px;
    }
    @keyframes scaleIn { from { transform: scale(.92); } to { transform: scale(1); } }
    .modal-close {
      position: absolute; top: 12px; right: 16px;
      background: none; border: none; font-size: 24px; color: #174ca7;
      cursor: pointer; outline: none;
    }
    .modal-nav {
      display: flex; gap: 8px; margin-bottom: 18px; flex-wrap: wrap;
      justify-content: center;
    }
    .modal-nav button {
      background: #e9edfc; color: #1a3167; padding: 6px 14px;
      border-radius: 5px; border: none; font-size: 15px; font-weight: bold;
      transition: background .2s, color .2s;
    }
    .modal-nav button.active,
    .modal-nav button:hover {
      background: #ffe164; color: #193356;
    }
    /* Features lists */
    .explainer-features, .modal-features {
      display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;
      margin: 12px 0;
    }
    .explainer-feature, .modal-feature {
      background: #1a2d50; color: #ffe164;
      padding: 8px 14px; border-radius: 6px; min-width: 100px;
      font-size: 0.9rem; text-align: center;
    }
    /* Explainer section */
    .explainer-section {
      background: rgba(255,255,255,0.12); border-radius: 10px;
      padding: 24px; margin: 20px auto; max-width: 720px; width: 95%;
      box-shadow: 0 4px 24px rgba(0,0,0,0.07); text-align: left;
    }
    .explainer-section h2 { color: #ffe164; font-size: 1.8rem; }
    .explainer-links button {
      background: none; border: none; color: #fff;
      text-decoration: underline; font-weight: bold; cursor: pointer;
      margin-right: 12px; padding: 0;
    }
    .explainer-links .audit-btn {
      background: none; border: 2px solid #ffe164; color: #ffe164;
      border-radius: 5px; padding: 4px 12px; font-weight: bold;
    }
    .onboarding-tip {
      background: #0d2b43; color: #7fffd4; padding: 8px 12px;
      border-radius: 5px; margin-top: 12px; display: inline-block;
      font-size: 1rem;
    }
    /* Floating help FAB */
    .help-fab {
      position: fixed; bottom: 24px; right: 24px; z-index: 1001;
      background: #ffe164; color: #15264d; width: 60px; height: 60px;
      border-radius: 50%; border: none; font-size: 28px; cursor: pointer;
      box-shadow: 0 6px 20px rgba(0,0,0,0.4); outline: none;
      transition: background .2s;
    }
    .help-fab:hover, .help-fab:focus { background: #fff0b2; }
    /* Toast */
    .toast {
      position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
      background: #10b981; color: #fff; padding: 14px 28px;
      border-radius: 6px; box-shadow: 0 4px 24px rgba(0,0,0,0.3);
      font-weight: bold; display: none; z-index: 1002;
    }
    .toast.toast-error { background: #ef4444; }
    /* Responsive */
    @media (max-width: 768px) {
      .input-field { width: 90%; }
      .explainer-section, .modal-content, .popup-content {
        width: 95%; padding: 16px;
      }
    }
    @media (max-width: 480px) {
      button, .show-hide-btn { font-size: 13px; padding: 6px 10px; }
      .explainer-feature, .modal-feature { font-size: 0.8rem; }
    }
  </style>
</head>

<body>
  <!-- Explainer -->
  <div class="explainer-section" role="complementary">
    <h2>BalanceChain: Digital Money. Redefined.</h2>
    <p><strong>1 TVM = 1 USD. Always. Backed by human effort, not speculation.</strong></p>
    <div class="explainer-features">
      <div class="explainer-feature">Pegged & Stable</div>
      <div class="explainer-feature">Audit-Proof</div>
      <div class="explainer-feature">Human-Effort Backed</div>
      <div class="explainer-feature">Instant, P2P & Private</div>
      <div class="explainer-feature">Works Offline</div>
      <div class="explainer-feature">No Middlemen</div>
    </div>
    <div class="explainer-links">
      <button onclick="openModal('whitepaperModal')">White Paper</button>
      <button onclick="openModal('faqModal')">FAQ</button>
      <button onclick="openModal('supportModal')">Support</button>
      <button onclick="openModal('communityModal')">Community</button>
      <button onclick="openModal('legalModal')">Legal</button>
      <button class="audit-btn" onclick="openModal('auditModal')">Audit Peg</button>
    </div>
    <div class="onboarding-tip" id="onboardingTip" style="display:none">
      <strong>Tip:</strong> Back up your vault now. Lose your passphrase or backup, lose your funds.
    </div>
  </div>

  <!-- Help FAB -->
  <button class="help-fab" aria-label="Help" onclick="openModal('faqModal')">?</button>

  <!-- Onboarding Modal -->
  <div id="onboardingModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('onboardingModal')">&times;</button>
      <div class="modal-nav">
        <button class="active" onclick="modalNav('onboardingModal',0)">Welcome</button>
        <button onclick="modalNav('onboardingModal',1)">How It Works</button>
        <button onclick="modalNav('onboardingModal',2)">Security</button>
      </div>
      <div class="modal-onboarding-page">
        <h2>Welcome to Bio-Vault</h2>
        <p>Your vault is the world’s first truly fair, pegged, and audit-proof digital money system.</p>
        <button onclick="modalNav('onboardingModal',1)">Next →</button>
      </div>
      <div class="modal-onboarding-page hidden">
        <h2>How It Works</h2>
        <ul>
          <li>Create your vault—keys & proofs stay local.</li>
          <li>Earn & transfer TVM instantly—no banks.</li>
          <li>1 TVM = 12 SHE = 1 USD. Peg never breaks.</li>
          <li>Audit or move on-chain any time.</li>
        </ul>
        <button onclick="modalNav('onboardingModal',2)">Next →</button>
      </div>
      <div class="modal-onboarding-page hidden">
        <h2>Security First</h2>
        <ul>
          <li><strong>Backup now.</strong> Lose your passphrase or backup, lose your funds.</li>
          <li>We can’t recover your vault. It’s yours.</li>
          <li>Keep a copy safe & never share your passphrase.</li>
        </ul>
        <button onclick="closeModal('onboardingModal')">Got it</button>
      </div>
    </div>
  </div>

  <!-- Whitepaper Modal -->
  <div id="whitepaperModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('whitepaperModal')">&times;</button>
      <div class="modal-nav">
        <button class="active" onclick="openModal('whitepaperModal')">White Paper</button>
        <button onclick="openModal('faqModal')">FAQ</button>
        <button onclick="openModal('auditModal')">Audit Peg</button>
        <button onclick="openModal('supportModal')">Support</button>
        <button onclick="openModal('communityModal')">Community</button>
        <button onclick="openModal('legalModal')">Legal</button>
      </div>
      <h2>BalanceChain White Paper (Summary)</h2>
      <div class="modal-features">
        <div class="modal-feature">Pegged 1 TVM=1 USD</div>
        <div class="modal-feature">Audit-Proof</div>
        <div class="modal-feature">Human-Effort Backed</div>
      </div>
      <ul>
        <li><strong>TVM</strong> pegged, always redeemable 1:1 USD.</li>
        <li>Every unit backed by cryptographic proof.</li>
        <li>No mining, no speculation, protocol-enforced stability.</li>
        <li>Self-custodial, offline, instantly auditable.</li>
        <li>On-chain TVM always 100% backed.</li>
      </ul>
      <p class="modal-tip">For full paper, contact support or join our community.</p>
    </div>
  </div>

  <!-- Audit Modal -->
  <div id="auditModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('auditModal')">&times;</button>
      <div class="modal-nav">
        <button onclick="openModal('whitepaperModal')">White Paper</button>
        <button onclick="openModal('faqModal')">FAQ</button>
        <button class="active" onclick="openModal('auditModal')">Audit Peg</button>
        <button onclick="openModal('supportModal')">Support</button>
        <button onclick="openModal('communityModal')">Community</button>
        <button onclick="openModal('legalModal')">Legal</button>
      </div>
      <h2>Audit the Peg</h2>
      <p>
        <strong>Why TVM is always $1:</strong> Peg enforced by code & smart contract.<br>
        <strong>Current Supply:</strong> <span id="auditPegLive">Loading...</span>
      </p>
      <p class="modal-tip">No one—even creators—can break the peg or freeze your funds.</p>
    </div>
  </div>

  <!-- FAQ Modal -->
  <div id="faqModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('faqModal')">&times;</button>
      <div class="modal-nav">
        <button onclick="openModal('whitepaperModal')">White Paper</button>
        <button class="active" onclick="openModal('faqModal')">FAQ</button>
        <button onclick="openModal('auditModal')">Audit Peg</button>
        <button onclick="openModal('supportModal')">Support</button>
        <button onclick="openModal('communityModal')">Community</button>
        <button onclick="openModal('legalModal')">Legal</button>
      </div>
      <h2>FAQ</h2>
      <ul>
        <li><strong>How is TVM always $1?</strong> Protocol & contract enforce the peg.</li>
        <li><strong>What is Bio-IBAN?</strong> Your private, cryptographically secure account ID.</li>
        <li><strong>What is Bio-Catch?</strong> A cryptographic proof of transfer.</li>
        <li><strong>Lost vault?</strong> Funds are gone. Always back up.</li>
        <li><strong>Use on-chain?</strong> Yes—connect your on-chain wallet.</li>
        <li><strong>Privacy?</strong> Keys & proofs stay local unless you share.</li>
        <li><strong>Audit-proof?</strong> Every coin’s history is provable & exportable.</li>
      </ul>
    </div>
  </div>

  <!-- Support Modal -->
  <div id="supportModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('supportModal')">&times;</button>
      <div class="modal-nav">
        <button onclick="openModal('whitepaperModal')">White Paper</button>
        <button onclick="openModal('faqModal')">FAQ</button>
        <button onclick="openModal('auditModal')">Audit Peg</button>
        <button class="active" onclick="openModal('supportModal')">Support</button>
        <button onclick="openModal('communityModal')">Community</button>
        <button onclick="openModal('legalModal')">Legal</button>
      </div>
      <h2>Support</h2>
      <p>
        Bug reports & questions:<br>
        <strong>Email:</strong> <a href="mailto:support@shemoney.app">support@shemoney.app</a><br>
        <strong>Telegram:</strong> <a href="https://t.me/yourcommunity" target="_blank">@yourcommunity</a>
      </p>
    </div>
  </div>

  <!-- Community Modal -->
  <div id="communityModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('communityModal')">&times;</button>
      <div class="modal-nav">
        <button onclick="openModal('whitepaperModal')">White Paper</button>
        <button onclick="openModal('faqModal')">FAQ</button>
        <button onclick="openModal('auditModal')">Audit Peg</button>
        <button onclick="openModal('supportModal')">Support</button>
        <button class="active" onclick="openModal('communityModal')">Community</button>
        <button onclick="openModal('legalModal')">Legal</button>
      </div>
      <h2>Community</h2>
      <p>
        Join us:<br>
        <strong>Telegram:</strong> <a href="https://t.me/yourcommunity" target="_blank">@yourcommunity</a><br>
        <strong>Discord:</strong> <a href="https://discord.gg/yourserver" target="_blank">discord.gg/yourserver</a>
      </p>
    </div>
  </div>

  <!-- Legal Modal -->
  <div id="legalModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('legalModal')">&times;</button>
      <div class="modal-nav">
        <button onclick="openModal('whitepaperModal')">White Paper</button>
        <button onclick="openModal('faqModal')">FAQ</button>
        <button onclick="openModal('auditModal')">Audit Peg</button>
        <button onclick="openModal('supportModal')">Support</button>
        <button onclick="openModal('communityModal')">Community</button>
        <button class="active" onclick="openModal('legalModal')">Legal</button>
      </div>
      <h2>Legal & Privacy</h2>
      <p>
        <strong>Terms:</strong> Experimental, open-source. You’re fully responsible for your vault.<br>
        <strong>Privacy:</strong> No personal data collected. All keys stay local.
      </p>
    </div>
  </div>

  <!-- Change Passphrase Modal -->
  <div id="changePassModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('changePassModal')">&times;</button>
      <h3>Change Passphrase</h3>
      <label for="oldPassInput">Old Passphrase:</label><br>
      <div class="pass-wrap">
        <input type="password" id="oldPassInput" class="input-field"><button class="show-hide-btn" onclick="togglePassword('oldPassInput', this)">Show</button>
      </div>
      <label for="newPassInput">New Passphrase:</label><br>
      <div class="pass-wrap">
        <input type="password" id="newPassInput" class="input-field"><button class="show-hide-btn" onclick="togglePassword('newPassInput', this)">Show</button>
      </div>
      <label for="confirmNewPassInput">Confirm New Passphrase:</label><br>
      <div class="pass-wrap">
        <input type="password" id="confirmNewPassInput" class="input-field"><button class="show-hide-btn" onclick="togglePassword('confirmNewPassInput', this)">Show</button>
      </div>
      <button onclick="closeModal('changePassModal')">Cancel</button>
      <button id="changePassSaveBtn">Save</button>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div id="confirmModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content" tabindex="0">
      <button class="modal-close" onclick="closeModal('confirmModal')">&times;</button>
      <h3 id="confirmModalTitle">Confirm</h3>
      <p id="confirmModalMessage">Are you sure?</p>
      <button onclick="closeModal('confirmModal')">Cancel</button>
      <button id="confirmModalConfirmBtn" style="background:#10b981;">Yes</button>
    </div>
  </div>

  <!-- Locked Screen -->
  <div id="lockedScreen" role="main">
    <h1>Bio-Vault</h1>
    <h2>YOUR MONEY<br>TRULY YOURS</h2>
    <button id="enterVaultBtn">Enter Vault</button>
  </div>

  <!-- Vault UI -->
  <div id="vaultUI" class="hidden" role="region" aria-label="Vault Interface">
    <!-- IBAN & Bio-Catch -->
    <div class="section">
      <label for="bioibanInput">Your Bio-IBAN:</label><br>
      <input type="text" id="bioibanInput" class="input-field" readonly placeholder="BIO…">
      <button id="copyBioIBANBtn">Copy</button>
      <button id="showBioCatchBtn">Show Bio-Catch</button>
    </div>

    <!-- Balance & Peg -->
    <div class="section" id="balanceContainer">
      <span id="tvmBalance">Balance: 0 TVM</span><br>
      <span id="usdBalance">Equivalent: 0 USD</span><br>
      <small id="auditPegLive">Loading peg…</small>
    </div>

    <!-- Bonus Constant & Time -->
    <div class="section" id="bioLineUTCContainer">
      <div id="bioLineText">🔄 BonusConstant: 0</div>
      <div id="utcTime">UTC Time: …</div>
    </div>

    <!-- Wallet & Claim -->
    <div class="section">
      <label for="userWalletAddress">On-Chain Wallet:</label><br>
      <input type="text" id="userWalletAddress" class="input-field" placeholder="0x…">
      <button id="saveWalletBtn">Save Wallet</button>
      <button id="autoConnectWalletBtn">MetaMask</button>
    </div>
    <div class="section" id="tvmClaimSection">
      <span id="tvmClaimable">TVM Claimable: 0</span>
      <button id="claimTvmBtn">Claim TVM</button>
    </div>

    <!-- Catch In/Out -->
    <div class="section" id="catchInSection">
      <input type="text" id="catchInBioCatch" class="input-field" placeholder="Bio-Catch #">
      <input type="number" id="catchInAmount" class="input-field" placeholder="Amount">
      <button id="catchInBtn">Catch In</button>
    </div>
    <div class="section" id="catchOutSection">
      <input type="text" id="receiverBioIBAN" class="input-field" placeholder="Receiver IBAN">
      <input type="number" id="catchOutAmount" class="input-field" placeholder="Amount">
      <button id="catchOutBtn">Catch Out</button>
    </div>

    <!-- Export & Import -->
    <div class="section">
      <button id="exportBtn">Export Txns</button>
      <button id="exportBackupBtn">Backup Vault</button>
      <button id="exportFriendlyBtn">Friendly Backup</button><br>
      <label for="importVaultFileInput">Import .vault:</label>
      <input type="file" id="importVaultFileInput" accept=".vault">
    </div>

    <!-- Transaction History -->
    <div class="section">
      <p id="txEmptyState" style="display:none; color:#ffe164;">
        No transactions yet.
      </p>
      <button id="txPrevBtn" style="display:none;">Prev</button>
      <button id="txNextBtn" style="display:none;">Next</button>
    </div>
    <table id="transactionTable">
      <thead>
        <tr>
          <th>Bio-IBAN</th>
          <th>Bio-Catch</th>
          <th>Amount</th>
          <th>Date/Time</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="transactionBody"></tbody>
    </table>
  </div>

  <!-- Bio-Catch Popup -->
  <div id="bioCatchPopup" class="popup" role="dialog" aria-modal="true">
    <div class="popup-content">
      <h3>Your Bio-Catch</h3>
      <p id="bioCatchNumberText"></p>
      <button id="copyBioCatchBtn">Copy</button>
      <button id="closeBioCatchPopup">Close</button>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Footer -->
  <footer class="section">
    <a href="privacy.html" style="color:#ffe164;">Privacy Policy</a> |
    <a href="terms.html" style="color:#ffe164;">Terms</a><br>
    <small>&copy; <span id="currentYear"></span> RR.R — for Humanity.</small>
  </footer>
  <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>

  <!-- Inline Helpers & Initialization -->
  <script>
    // Modal controls, password toggles, toast, paging, onboarding reminders, etc.
    // (Matches what's expected by main.js)
    function openModal(id){document.querySelectorAll('.modal').forEach(m=>m.style.display='none');let m=document.getElementById(id);if(m){m.style.display='flex';let f=m.querySelector('[tabindex]');if(f)f.focus();}document.body.style.overflow='hidden';}
    function closeModal(id){let m=document.getElementById(id);if(m)m.style.display='none';document.body.style.overflow='';}
    function modalNav(mid,i){let m=document.getElementById(mid),pages=m.querySelectorAll('.modal-onboarding-page'),navs=m.querySelectorAll('.modal-nav button');pages.forEach((p,idx)=>p.classList.toggle('hidden',idx!==i));navs.forEach((b,idx)=>b.classList.toggle('active',idx===i));}
    function togglePassword(i,b){let inp=document.getElementById(i);if(inp.type==='password'){inp.type='text';b.textContent='Hide';}else{inp.type='password';b.textContent='Show';}}
    function showToast(msg,err=false){let t=document.getElementById('toast');t.textContent=msg;t.className='toast'+(err?' toast-error':'');t.style.display='block';setTimeout(()=>t.style.display='none',3300);}
    document.addEventListener('keydown',e=>{if(e.key==='Escape'){document.querySelectorAll('.modal').forEach(m=>m.style.display='none');document.body.style.overflow='';}});
    document.querySelectorAll('.modal').forEach(modal=>modal.addEventListener('click',e=>{if(e.target===modal){modal.style.display='none';document.body.style.overflow='';}}));
    // Onboard & backup reminders
    (()=>{
      if(!localStorage.getItem('vaultOnboarded')){openModal('onboardingModal');modalNav('onboardingModal',0);localStorage.setItem('vaultOnboarded','yes');}
      document.getElementById('exportBackupBtn').addEventListener('click',()=>{
        localStorage.setItem('vaultBackedUp','yes');
        document.getElementById('onboardingTip').style.display='none';
        showToast('Backup exported.');
      });
      if(!localStorage.getItem('vaultBackedUp')) document.getElementById('onboardingTip').style.display='';
      // Wire bio-catch popup
      document.getElementById('showBioCatchBtn').addEventListener('click',()=>{
        const val=`BC-${Date.now()}-${Math.floor(Math.random()*1e5)}`;
        document.getElementById('bioCatchNumberText').textContent=val;
        openModal('bioCatchPopup');
      });
      document.getElementById('closeBioCatchPopup').addEventListener('click',()=>closeModal('bioCatchPopup'));
      document.getElementById('copyBioCatchBtn').addEventListener('click',()=>{navigator.clipboard.writeText(document.getElementById('bioCatchNumberText').textContent).then(()=>showToast('Copied!')).catch(()=>showToast('Copy failed',true));});
      // Paging
      window.transactions=[];
      window.txPage=0;const pageSize=10;
      function renderTransactions(){
        const tb=document.getElementById('transactionBody');tb.innerHTML='';
        if(!transactions.length){document.getElementById('txEmptyState').style.display='block';document.getElementById('txPrevBtn').style.display='none';document.getElementById('txNextBtn').style.display='none';return;}
        document.getElementById('txEmptyState').style.display='none';
        const start=txPage*pageSize,end=start+pageSize;
        transactions.slice(start,end).forEach(tx=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${tx.bioIban}</td><td>${tx.bioCatch}</td><td>${tx.amount}</td><td>${tx.time}</td><td>${tx.status}</td>`;tb.appendChild(tr);});
        document.getElementById('txPrevBtn').style.display=txPage>0?'inline-block':'none';
        document.getElementById('txNextBtn').style.display=end<transactions.length?'inline-block':'none';
      }
      document.getElementById('txPrevBtn').addEventListener('click',()=>{txPage--;renderTransactions();});
      document.getElementById('txNextBtn').addEventListener('click',()=>{txPage++;renderTransactions();});
    })();
  </script>

  <!-- Main App Script -->
  <script type="module" src="main.js"></script>
</body>
</html>
